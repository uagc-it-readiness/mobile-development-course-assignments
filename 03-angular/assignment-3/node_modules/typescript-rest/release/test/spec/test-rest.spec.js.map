{"version":3,"sources":["../../src/spec/test-rest.ts"],"names":[],"mappings":"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","file":"test-rest.spec.js","sourcesContent":["\"use strict\";\n\nimport * as express from \"express\";\nimport * as request from 'request';\nimport * as fs from \"fs\";\nimport * as _ from \"lodash\";\nimport {Inject, AutoWired} from \"typescript-ioc\";\n\nimport {Path, Server, GET, POST, PUT, DELETE, HttpMethod,\n\t\tPathParam, QueryParam, CookieParam, HeaderParam, \n\t\tFormParam, Param, Context, ServiceContext, ContextRequest, \n\t\tContextResponse, ContextLanguage, ContextAccept, \n\t\tContextNext, AcceptLanguage, Accept, FileParam, \n\t\tErrors, Return} from \"../lib/typescript-rest\";\n\nServer.useIoC();\n\nclass Person {\n\tconstructor(id: number, name: string, age: number) {\n\t\tthis.id = id;\n\t\tthis.name = name;\n\t\tthis.age = age;\n\t}\n\tid: number;\n\tname: string;\n\tage: number;\n}\n\n@AutoWired\nclass InjectableObject {\n\n}\n\n@AutoWired\n@Path(\"ioctest\")\nclass MyIoCService {\n\t@Inject\n\tprivate injectedObject: InjectableObject\n\t\n\t@GET\n\ttest( ): string {\n\t\treturn (this.injectedObject)?\"OK\":\"NOT OK\";\n\t}\n}\n\n@Path(\"ioctest2\")\n@AutoWired\nclass MyIoCService2 {\n\t@Inject\n\tprivate injectedObject: InjectableObject\n\t\n\t@GET\n\ttest( ): string {\n\t\treturn (this.injectedObject)?\"OK\":\"NOT OK\";\n\t}\n}\n\n@Path(\"mypath\")\nclass MyService {\n\t@GET\n\ttest( ): string {\n\t\treturn \"OK\";\n\t}\n\n\t@GET\n\t@Path(\"secondpath\")\n\ttest2( ): string {\n\t\treturn \"OK\";\n\t}\n}\n\n@Path(\"mypath2\")\nclass MyService2 {\n\t@GET\n\t@Path(\"secondpath\")\n\ttest( ): string {\n\t\treturn \"OK\";\n\t}\n}\n\n@Path(\"/asubpath/person\")\nclass PersonService {\n\t@Path(\":id\")\n\t@GET\n\tgetPerson( @PathParam('id') id: number): Promise<Person> {\n\t\treturn new Promise<Person>(function(resolve, reject){\n\t\t\tresolve(new Person(id, \"Fulano de Tal número \" + id.toString(), 35));\n\t\t});\n\t}\n\n\t@PUT\n\t@Path(\"/:id\")\n\tsetPerson( person: Person): boolean {\n\t\treturn true;\n\t}\n\n\t@POST\n\taddPerson(@ContextRequest req: express.Request, person: Person): Return.NewResource {\n\t\treturn new Return.NewResource(req.url + \"/\" + person.id);\n\t}\n\n\t@GET\n\tgetAll( @QueryParam('start') start: number, \n\t\t    @QueryParam('size') size: number): Person[] {\n\t\tlet result: Array<Person> = new Array<Person>();\n\n\t\tfor (let i: number = start; i < (start + size); i++) {\n\t\t\tresult.push(new Person(i, \"Fulano de Tal número \" + i.toString(), 35));\n\t\t}\n\t\treturn result;\n\t}\n}\n\nclass TestParams {\n\t\n\t@Context\n\tcontext: ServiceContext;\n\n\t@GET\n\t@Path(\"headers\")\n\ttestHeaders( @HeaderParam('my-header') header: string,\n\t\t\t\t @CookieParam('my-cookie') cookie: string): string {\n\t\treturn \"cookie: \" + cookie + \"|header: \"+header;\n\t}\n\n\t@POST\n\t@Path(\"multi-param\")\n\ttestMultiParam( @Param('param') param: string): string {\n\t\treturn param;\n\t}\n\n\t@GET\n\t@Path(\"context\")\n\ttestContext( @QueryParam('q') q: string,\n\t\t@ContextRequest request: express.Request,\n\t\t@ContextResponse response: express.Response,\n\t\t@ContextNext next: express.NextFunction): void {\n\n\t\tif (request && response && next) {\n\t\t\tresponse.status(201);\n\t\t\tif (q === \"123\") {\n\t\t\t\tresponse.send(true);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tresponse.send(false);\n\t\t\t}\n\t\t}\n\t}\n\n\t@POST\n\t@Path(\"upload\")\n\ttestUploadFile( @FileParam(\"myFile\") file: Express.Multer.File, \n\t\t\t\t\t@FormParam(\"myField\") myField: string): boolean {\n\t\treturn (file \n\t\t && (_.startsWith(file.buffer.toString(),'\"use strict\";')) \n\t     && (myField === \"my_value\"));\n\t}\n}\n\n@Path(\"download\")\nclass TestDownload {\n\t@GET\n\ttestDownloadFile(): Promise<Return.DownloadBinaryData> {\n\t\treturn new Promise<Return.DownloadBinaryData>((resolve, reject)=>{\n\t\t\tfs.readFile(__dirname + '/test-rest.spec.js', (err, data)=>{\n\t\t\t\tif (err) {\n\t\t\t\t\treturn reject(err);\n\t\t\t\t}\n\t\t\t\treturn resolve(new Return.DownloadBinaryData(data, 'application/javascript', 'test-rest.spec.js'))\n\t\t\t});\n\t\t});\n\t}\n}\n\n@Path(\"/accept\")\n@AcceptLanguage(\"en\", \"pt-BR\")\nclass AcceptTest {\n\n\t@GET\n\ttestLanguage(@ContextLanguage language: string): string {\n\t\tif (language === 'en') {\n\t\t\treturn \"accepted\";\n\t\t}\n\t\treturn \"aceito\";\n\t}\n\n\t@GET\n\t@Path(\"types\")\n\t@Accept(\"application/json\")\n\ttestAccepts(@ContextAccept type: string): string {\n\t\tif (type === 'application/json') {\n\t\t\treturn \"accepted\";\n\t\t}\n\t\treturn \"not accepted\"\n\t}\n\n\t@PUT\n\t@Path(\"conflict\")\n\ttestConflict(): string {\n\t\tthrow new Errors.ConflictError(\"test of conflict\");\n\t}\n\n\n\t@POST\n\t@Path(\"conflict\")\n\ttestConflictAsync(): Promise<string> {\n\t\treturn new Promise<string>(function(resolve, reject){\n\t\t\tthrow new Errors.ConflictError(\"test of conflict\");\n\t\t});\n\t}\n}\n\nlet app: express.Application = express();\napp.set('env', 'test');\nServer.buildServices(app);\n//Server.buildServices(app, PersonService, TestParams, AcceptTest);\n\nlet server;\ndescribe(\"Server Tests\", () => {\n\n\tbeforeAll(function(){\n\t\tserver = app.listen(5674);\n\t});\n\n\tafterAll(function(){\n\t\tserver.close();\n\t});\n\n\tdescribe(\"Server\", () => {\n\t\tit(\"should provide a catalog containing the exposed paths\", () => {\n\t\t\texpect(Server.getPaths().indexOf(\"/mypath\")).toBeGreaterThan(-1);\n\t\t\texpect(Server.getPaths().indexOf(\"/ioctest\")).toBeGreaterThan(-1);\n\t\t\texpect(Server.getPaths().indexOf(\"/ioctest2\")).toBeGreaterThan(-1);\n\t\t\texpect(Server.getPaths().indexOf(\"/mypath2/secondpath\")).toBeGreaterThan(-1);\t\t\t\n\t\t\texpect(Server.getPaths().indexOf(\"/asubpath/person/:id\")).toBeGreaterThan(-1);\n\t\t\texpect(Server.getPaths().indexOf(\"/headers\")).toBeGreaterThan(-1);\n\t\t\texpect(Server.getPaths().indexOf(\"/multi-param\")).toBeGreaterThan(-1);\n\t\t\texpect(Server.getPaths().indexOf(\"/context\")).toBeGreaterThan(-1);\n\t\t\texpect(Server.getPaths().indexOf(\"/upload\")).toBeGreaterThan(-1);\n\t\t\texpect(Server.getPaths().indexOf(\"/download\")).toBeGreaterThan(-1);\n\t\t\texpect(Server.getHttpMethods(\"/asubpath/person/:id\").indexOf(HttpMethod.GET)).toBeGreaterThan(-1);\n\t\t\texpect(Server.getHttpMethods(\"/asubpath/person/:id\").indexOf(HttpMethod.PUT)).toBeGreaterThan(-1);\n\t\t\texpect(Server.getPaths().indexOf(\"/accept\")).toBeGreaterThan(-1);\n\t\t\texpect(Server.getPaths().indexOf(\"/accept/conflict\")).toBeGreaterThan(-1);\n\t\t});\n\t});\n\n\tdescribe(\"PersonService\", () => {\n\t\tit(\"should return the person (123) for GET on path: /asubpath/person/123\", (done) => {\n\t\t\trequest(\"http://localhost:5674/asubpath/person/123\", function(error, response, body) {\n\t\t\t\tlet result: Person = JSON.parse(body);\n\t\t\t\texpect(result.id).toEqual(123);\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\t\n\t\tit(\"should return true for PUT on path: /asubpath/person/123\", (done) => {\n\t\t\trequest.put({ \n\t\t\t\theaders: { 'content-type': 'application/json' },\n\t\t\t\turl: \"http://localhost:5674/asubpath/person/123\", \n\t\t\t\tbody: JSON.stringify(new Person(123, \"Fulano de Tal número 123\", 35))\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(body).toEqual(\"true\");\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\n\t\tit(\"should return 201 for POST on path: /asubpath/person\", (done) => {\n\t\t\trequest.post({ \n\t\t\t\theaders: { 'content-type': 'application/json' },\n\t\t\t\turl: \"http://localhost:5674/asubpath/person\", \n\t\t\t\tbody: JSON.stringify(new Person(123, \"Fulano de Tal número 123\", 35))\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(response.statusCode).toEqual(201);\n\t\t\t\texpect(response.headers['location']).toEqual(\"/asubpath/person/123\");\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\n\t\tit(\"should return an array with 3 elements for GET on path: /asubpath/person?start=0&size=3\", (done) => {\n\t\t\trequest(\"http://localhost:5674/asubpath/person?start=0&size=3\", function(error, response, body) {\n\t\t\t\tlet result: Array<Person> = JSON.parse(body);\n\t\t\t\texpect(result.length).toEqual(3);\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\t});\n\n\tdescribe(\"MyService\", () => {\n\t\tit(\"should configure a path without an initial /\", (done) => {\n\t\t\trequest(\"http://localhost:5674/mypath\", function(error, response, body) {\n\t\t\t\texpect(body).toEqual(\"OK\");\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\t});\n\n\tdescribe(\"MyIoCService\", () => {\n\t\tit(\"should use IoC container to instantiate the services\", (done) => {\n\t\t\trequest(\"http://localhost:5674/ioctest\", function(error, response, body) {\n\t\t\t\texpect(body).toEqual(\"OK\");\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\t\tit(\"should use IoC container to instantiate the services, does not carrying about the decorators order\", (done) => {\n\t\t\trequest(\"http://localhost:5674/ioctest2\", function(error, response, body) {\n\t\t\t\texpect(body).toEqual(\"OK\");\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\t});\n\n\tdescribe(\"MyService2\", () => {\n\t\tit(\"should configure a path on method \", (done) => {\n\t\t\trequest(\"http://localhost:5674/mypath2/secondpath\", function(error, response, body) {\n\t\t\t\texpect(body).toEqual(\"OK\");\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\t\t\n\t});\n\n\n\tdescribe(\"TestParams\", () => {\n\t\tit(\"should parse header and cookies correclty\", (done) => {\n\t\t\trequest({\n\t\t\t\theaders: { 'my-header': 'header value', 'Cookie': 'my-cookie=cookie value' },\n\t\t\t\turl: \"http://localhost:5674/headers\"\t\t\t\t\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(body).toEqual(\"cookie: cookie value|header: header value\");\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\n\t\tit(\"should parse multi param as query param\", (done) => {\n\t\t\trequest.post({\n\t\t\t\turl: \"http://localhost:5674/multi-param?param=myQueryValue\"\t\t\t\t\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(body).toEqual(\"myQueryValue\");\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\n\t\tit(\"should parse multi param as form param\", (done) => {\n\t\t\tlet form = {\n\t\t\t\t'param': 'formParam'\n\t\t\t};\n\t\t\tlet req = request.post({\n\t\t\t\t\t\"url\": \"http://localhost:5674/multi-param\",\n\t\t\t\t\t\"form\": form\n\t\t\t\t}, function(error, response, body) {\n\t\t\t\t\texpect(body).toEqual(\"formParam\");\n\t\t\t\t\texpect(response.statusCode).toEqual(200);\n\t\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\n\t\tit(\"should accept Context parameters\", (done) => {\n\t\t\trequest({\n\t\t\t\turl: \"http://localhost:5674/context?q=123\"\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(body).toEqual(\"true\");\n\t\t\t\texpect(response.statusCode).toEqual(201);\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\n\t\tit(\"should accept file parameters\", (done) => {\n\t\t\tlet req = request.post(\"http://localhost:5674/upload\", function(error, response, body) {\n\t\t\t\texpect(body).toEqual(\"true\");\n\t\t\t\texpect(response.statusCode).toEqual(200);\n\t\t\t\tdone();\n\t\t\t});\n\t\t\tlet form: FormData = req.form();\n\t\t\tform.append('myField', 'my_value');\n\t\t\tform.append('myFile', fs.createReadStream(__dirname + '/test-rest.spec.js'), 'test-rest.spec.js');\n\t\t});\n\t});\n\tdescribe(\"TestDownload\", () => {\n\t\tit(\"should return a file\", (done) => {\n\t\t\trequest({\n\t\t\t\turl: \"http://localhost:5674/download\"\t\t\t\t\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(response.headers['content-type']).toEqual('application/javascript');\n\t\t\t\texpect(_.startsWith(body.toString(),'\"use strict\";')).toEqual(true);\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\t});\n\n\tdescribe(\"AcceptTest\", () => {\n\t\tit(\"should choose language correctly\", (done) => {\n\t\t\trequest({\n\t\t\t\theaders: { 'Accept-Language': 'pt-BR' },\n\t\t\t\turl: \"http://localhost:5674/accept\"\t\t\t\t\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(body).toEqual(\"aceito\");\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\n\t\tit(\"should reject unacceptable languages\", (done) => {\n\t\t\trequest({\n\t\t\t\theaders: { 'Accept-Language': 'fr' },\n\t\t\t\turl: \"http://localhost:5674/accept\"\t\t\t\t\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(response.statusCode).toEqual(406);\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\n\t\tit(\"should use default language if none specified\", (done) => {\n\t\t\trequest({\n\t\t\t\turl: \"http://localhost:5674/accept\"\t\t\t\t\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(body).toEqual(\"accepted\");\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\n\t\tit(\"should use default media type if none specified\", (done) => {\n\t\t\trequest({\n\t\t\t\turl: \"http://localhost:5674/accept/types\"\t\t\t\t\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(body).toEqual(\"accepted\");\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\t\tit(\"should handle RestErrors\", (done) => {\n\t\t\trequest.put({\n\t\t\t\theaders: { 'Accept': 'text/html' },\n\t\t\t\turl: \"http://localhost:5674/accept/conflict\",\t\t\t\t\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(response.statusCode).toEqual(409);\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\t\tit(\"should handle RestErrors on Async calls\", (done) => {\n\t\t\trequest.post({\n\t\t\t\theaders: { 'Accept': 'text/html' },\n\t\t\t\turl: \"http://localhost:5674/accept/conflict\",\t\t\t\t\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(response.statusCode).toEqual(409);\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\t\tit(\"should reject unacceptable media types\", (done) => {\n\t\t\trequest({\n\t\t\t\theaders: { 'Accept': 'text/html' },\n\t\t\t\turl: \"http://localhost:5674/accept/types\"\t\t\t\t\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(response.statusCode).toEqual(406);\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\n\t});\n\n\tdescribe(\"Server\", () => {\n\t\tit(\"should return 404 when unmapped resources are requested\", (done) => {\n\t\t\trequest({\n\t\t\t\turl: \"http://localhost:5674/unmapped/resource\"\t\t\t\t\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(response.statusCode).toEqual(404);\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\n\t\tit(\"should return 405 when a not supported method is requeted to a mapped resource\", (done) => {\n\t\t\trequest.post({\n\t\t\t\turl: \"http://localhost:5674/asubpath/person/123\"\t\t\t\t\n\t\t\t}, function(error, response, body) {\n\t\t\t\texpect(response.statusCode).toEqual(405);\n\t\t\t\tlet allowed: string = response.headers['allow'];\n\t\t\t\texpect(allowed).toContain(\"GET\");\n\t\t\t\texpect(allowed).toContain(\"PUT\");\n\t\t\t\tdone();\n\t\t\t});\n\t\t});\n\t});\n\n});\n\n"]}